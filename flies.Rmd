---
title: "Flies Survival Analysis"
author: "Luis Gracia <lgraval@gmail.com>"
date: "May 6, 2018"
---

# Notebook general settings
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Set options
```{r}
inputfile = "test/tests.xlsx"
worksheet = "dead"
skip_unaccounted = FALSE        # TRUE/FALSE
```

# Process data
```{r include=FALSE}
source('flies_lib.R')
result = flies_process(inputfile, worksheet, skip_unaccounted)
```

# Results

## Tally
```{r}
result$tally
```

## Graph

```{r}
survival = survfit(Surv(days, event) ~ group, data = result$events)
surv_median(survival)
```

And create a pretty graph:

```{r}
ggsurvplot(survival, data = result$events, xlab="Days", palette="jco")
ggsurvplot(survival, data = result$events, xlab="Days", pval=T, conf.int=T, surv.median.line="hv", palette="jco")
```

We can also test for differences:
```{r}
survdiff(Surv(days, event) ~ group, data = result$events)
```
